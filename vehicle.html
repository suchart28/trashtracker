<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<title>‡∏£‡∏ñ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏¢‡∏∞‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÉ‡∏Å‡∏•‡πâ‡∏â‡∏±‡∏ô</title>

<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  body {
    font-family: "Kanit", sans-serif;
    text-align: center;
    padding-top: 50px;
    background: #f4f6f9;
  }
  #truck-id-display {
    font-size: 60px;
    margin-top: 20px;
    font-weight: 600;
  }
  #current-time {
    font-size: 28px;
    margin-top: 50px;
    color: #555;
  }
</style>
</head>
<body>

<h1>‡∏£‡∏ñ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏¢‡∏∞‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÉ‡∏Å‡∏•‡πâ‡∏â‡∏±‡∏ô</h1>

<label>‡∏õ‡πâ‡∏≠‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏ñ:</label>
<input type="text" id="truckId" placeholder="‡πÄ‡∏ä‡πà‡∏ô 12">
<button onclick="startSending()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πà‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</button>

<div id="truck-id-display"></div>
<div id="current-time"></div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDGYuI3yxJbUTc6T_0pm6WiEKZul11tXS0",
  authDomain: "suchartwork-1487382986748.firebaseapp.com",
  databaseURL: "https://suchartwork-1487382986748.firebaseio.com",
  projectId: "suchartwork-1487382986748",
  storageBucket: "suchartwork-1487382986748.firebasestorage.app",
  messagingSenderId: "353884592527",
  appId: "1:353884592527:web:0d5f392910ab0d2ceb13fa"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let truckIdentifier = "";

function startSending() {
  truckIdentifier = document.getElementById("truckId").value;
  if (!truckIdentifier) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡πâ‡∏≠‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏ñ");

  document.getElementById("truck-id-display").innerText = "üöõ ‡∏£‡∏ñ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç " + truckIdentifier;

  setInterval(() => {
    navigator.geolocation.getCurrentPosition(pos => {
      db.ref("trucks/" + truckIdentifier).set({
        lat: pos.coords.latitude,
        lng: pos.coords.longitude,
        timestamp: Date.now()
      });
    });
  }, 10000);

  // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤
  setInterval(() => {
    let t = new Date();
    document.getElementById("current-time").innerText = t.toLocaleTimeString();
  }, 1000);
}
</script>

</body>
</html>
